-- MATTHEW HIPPO - ULTIMATE FIXED & ENHANCED üíÄ
-- All bugs fixed + New OP chaos features!
-- By Skinny Nicolas for Matthew

print("ü¶õ Loading Ultimate Matthew Hippo...")

local Players = game:GetService("Players")
local RS = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local plr = Players.LocalPlayer
local mouse = plr:GetMouse()
local cam = workspace.CurrentCamera

local function getChar()
    return plr.Character
end

local function getRoot()
    local c = getChar()
    return c and c:FindFirstChild("HumanoidRootPart")
end

local function getHum()
    local c = getChar()
    return c and c:FindFirstChildOfClass("Humanoid")
end

-- Create GUI
local gui = Instance.new("ScreenGui")
gui.ResetOnSpawn = false
gui.Name = "MatthewHippo"
gui.Parent = plr:WaitForChild("PlayerGui")

local main = Instance.new("Frame")
main.Size = UDim2.new(0, 350, 0, 420)
main.Position = UDim2.new(0.5, -175, 0.5, -210)
main.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
main.BorderColor3 = Color3.fromRGB(255, 0, 0)
main.BorderSizePixel = 2
main.Active = true
main.Draggable = true
main.Parent = gui

local hd = Instance.new("Frame")
hd.Size = UDim2.new(1, 0, 0, 35)
hd.BackgroundColor3 = Color3.fromRGB(35, 0, 0)
hd.BorderSizePixel = 0
hd.Parent = main

local ti = Instance.new("TextLabel")
ti.Size = UDim2.new(1, -40, 1, 0)
ti.BackgroundTransparency = 1
ti.Text = "üíÄ MATTHEW HIPPO ULTIMATE üíÄ"
ti.TextColor3 = Color3.fromRGB(255, 0, 0)
ti.TextSize = 14
ti.Font = Enum.Font.GothamBold
ti.Parent = hd

local cl = Instance.new("TextButton")
cl.Size = UDim2.new(0, 30, 0, 30)
cl.Position = UDim2.new(1, -32, 0, 2.5)
cl.BackgroundColor3 = Color3.fromRGB(120, 0, 0)
cl.BorderSizePixel = 0
cl.Text = "X"
cl.TextColor3 = Color3.white
cl.TextSize = 14
cl.Font = Enum.Font.GothamBold
cl.Parent = hd
cl.MouseButton1Click:Connect(function() gui:Destroy() end)

local sc = Instance.new("ScrollingFrame")
sc.Size = UDim2.new(1, -10, 1, -45)
sc.Position = UDim2.new(0, 5, 0, 40)
sc.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
sc.BorderSizePixel = 0
sc.ScrollBarThickness = 4
sc.Parent = main

local ly = Instance.new("UIListLayout")
ly.Padding = UDim.new(0, 3)
ly.Parent = sc

local pd = Instance.new("UIPadding")
pd.PaddingTop = UDim.new(0, 3)
pd.PaddingLeft = UDim.new(0, 3)
pd.PaddingRight = UDim.new(0, 3)
pd.Parent = sc

local pl = Instance.new("Frame")
pl.Size = UDim2.new(0, 170, 0, 420)
pl.Position = UDim2.new(0.5, 185, 0.5, -210)
pl.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
pl.BorderColor3 = Color3.fromRGB(255, 0, 0)
pl.BorderSizePixel = 2
pl.Active = true
pl.Draggable = true
pl.Parent = gui

local ph = Instance.new("Frame")
ph.Size = UDim2.new(1, 0, 0, 30)
ph.BackgroundColor3 = Color3.fromRGB(35, 0, 0)
ph.BorderSizePixel = 0
ph.Parent = pl

local pt = Instance.new("TextLabel")
pt.Size = UDim2.new(1, 0, 1, 0)
pt.BackgroundTransparency = 1
pt.Text = "üë• PLAYERS"
pt.TextColor3 = Color3.fromRGB(255, 0, 0)
pt.TextSize = 12
pt.Font = Enum.Font.GothamBold
pt.Parent = ph

local ps = Instance.new("ScrollingFrame")
ps.Size = UDim2.new(1, -8, 1, -35)
ps.Position = UDim2.new(0, 4, 0, 32)
ps.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
ps.BorderSizePixel = 0
ps.ScrollBarThickness = 4
ps.Parent = pl

local pl2 = Instance.new("UIListLayout")
pl2.Padding = UDim.new(0, 2)
pl2.Parent = ps

local pp = Instance.new("UIPadding")
pp.PaddingTop = UDim.new(0, 2)
pp.PaddingLeft = UDim.new(0, 2)
pp.PaddingRight = UDim.new(0, 2)
pp.Parent = ps

-- Announcement system
local announcementFrame = Instance.new("Frame")
announcementFrame.Size = UDim2.new(0, 400, 0, 80)
announcementFrame.Position = UDim2.new(0.5, -200, 0, -100)
announcementFrame.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
announcementFrame.BorderColor3 = Color3.fromRGB(255, 0, 0)
announcementFrame.BorderSizePixel = 3
announcementFrame.Visible = false
announcementFrame.Parent = gui

local announcementText = Instance.new("TextLabel")
announcementText.Size = UDim2.new(1, 0, 1, 0)
announcementText.BackgroundTransparency = 1
announcementText.TextColor3 = Color3.fromRGB(255, 0, 0)
announcementText.TextSize = 18
announcementText.Font = Enum.Font.GothamBold
announcementText.TextWrapped = true
announcementText.Parent = announcementFrame

local function announce(text, duration)
    announcementText.Text = text
    announcementFrame.Position = UDim2.new(0.5, -200, 0, -100)
    announcementFrame.Visible = true
    TweenService:Create(announcementFrame, TweenInfo.new(0.5, Enum.EasingStyle.Back), {
        Position = UDim2.new(0.5, -200, 0, 20)
    }):Play()
    wait(duration or 3)
    TweenService:Create(announcementFrame, TweenInfo.new(0.3), {
        Position = UDim2.new(0.5, -200, 0, -100)
    }):Play()
    wait(0.3)
    announcementFrame.Visible = false
end

local st = {}
local cn = {}
local sel = nil
local pb = {}

local function b(t, c)
    local f = Instance.new("TextButton")
    f.Size = UDim2.new(1, -5, 0, 28)
    f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    f.BorderSizePixel = 1
    f.BorderColor3 = Color3.fromRGB(50, 50, 50)
    f.Text = t
    f.TextColor3 = Color3.fromRGB(220, 220, 220)
    f.TextSize = 10
    f.Font = Enum.Font.GothamBold
    f.Parent = sc
    f.MouseButton1Click:Connect(function() c(f) end)
    return f
end

local function pb2(tp)
    if pb[tp] then return end
    local f = Instance.new("TextButton")
    f.Size = UDim2.new(1, -4, 0, 26)
    f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    f.BorderSizePixel = 0
    f.Text = tp.Name
    f.TextColor3 = Color3.fromRGB(220, 220, 220)
    f.TextSize = 9
    f.Font = Enum.Font.Gotham
    f.Parent = ps
    f.MouseButton1Click:Connect(function()
        if sel and pb[sel] then pb[sel].BackgroundColor3 = Color3.fromRGB(35, 35, 35) end
        sel = tp
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üéØ SELECTED: " .. tp.Name, 1.5)
    end)
    pb[tp] = f
end

spawn(function()
    while wait(1) do
        pcall(function()
            for tp, v in pairs(pb) do
                if not Players:FindFirstChild(tp.Name) then
                    v:Destroy()
                    pb[tp] = nil
                    if sel == tp then sel = nil end
                end
            end
            for _, tp in pairs(Players:GetPlayers()) do
                if tp ~= plr then pb2(tp) end
            end
        end)
    end
end)

-- Reconnect features on respawn
plr.CharacterAdded:Connect(function(newChar)
    wait(0.5)
    for k, v in pairs(st) do
        st[k] = false
    end
    for k, v in pairs(cn) do
        if v and v.Disconnect then
            v:Disconnect()
        end
    end
    cn = {}
    announce("üîÑ RESPAWNED - Features Reset", 2)
end)

-- FIXED FLY (CFrame based - WORKS!)
b("FLY (WASD)", function(f)
    st.f = not st.f
    if st.f then
        local speed = 200
        cn.f = RS.Heartbeat:Connect(function()
            if not st.f then return end
            local root = getRoot()
            local hum = getHum()
            if not root or not hum then return end
            
            hum.PlatformStand = true
            
            local d = Vector3.new(0, 0, 0)
            if UIS:IsKeyDown(Enum.KeyCode.W) then d = d + cam.CFrame.LookVector end
            if UIS:IsKeyDown(Enum.KeyCode.S) then d = d - cam.CFrame.LookVector end
            if UIS:IsKeyDown(Enum.KeyCode.A) then d = d - cam.CFrame.RightVector end
            if UIS:IsKeyDown(Enum.KeyCode.D) then d = d + cam.CFrame.RightVector end
            if UIS:IsKeyDown(Enum.KeyCode.Space) then d = d + Vector3.new(0, 1, 0) end
            if UIS:IsKeyDown(Enum.KeyCode.LeftShift) then d = d - Vector3.new(0, 1, 0) end
            
            if d.Magnitude > 0 then
                root.CFrame = root.CFrame + (d.Unit * (speed / 60))
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üïäÔ∏è FLY ENABLED", 1.5)
    else
        if cn.f then cn.f:Disconnect() end
        local hum = getHum()
        if hum then hum.PlatformStand = false end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- FIXED NOCLIP + GOD MODE (No death in staff areas!)
b("NOCLIP + GOD", function(f)
    st.n = not st.n
    if st.n then
        cn.n = RS.Stepped:Connect(function()
            if not st.n then return end
            local char = getChar()
            if not char then return end
            
            -- Noclip
            for _, v in pairs(char:GetDescendants()) do
                if v:IsA("BasePart") then
                    v.CanCollide = false
                end
            end
            
            -- God mode - prevent death
            local hum = getHum()
            if hum and hum.Health < hum.MaxHealth then
                hum.Health = hum.MaxHealth
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üëª NOCLIP + GOD MODE", 1.5)
    else
        if cn.n then cn.n:Disconnect() end
        local char = getChar()
        if char then
            for _, v in pairs(char:GetDescendants()) do
                if v:IsA("BasePart") and v.Name ~= "HumanoidRootPart" then
                    v.CanCollide = true
                end
            end
        end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

b("SPEED", function(f)
    st.s = not st.s
    local hum = getHum()
    if hum then
        hum.WalkSpeed = st.s and 150 or 16
    end
    f.BackgroundColor3 = st.s and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(35, 35, 35)
end)

b("JUMP", function(f)
    st.j = not st.j
    local hum = getHum()
    if hum then
        hum.JumpPower = st.j and 200 or 50
    end
    f.BackgroundColor3 = st.j and Color3.fromRGB(255, 0, 0) or Color3.fromRGB(35, 35, 35)
end)

b("INF JUMP", function(f)
    st.i = not st.i
    if st.i then
        cn.i = UIS.JumpRequest:Connect(function()
            local hum = getHum()
            if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    else
        if cn.i then cn.i:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- FIXED HUMP (No hunching!)
b("HUMP", function(f)
    st.h = not st.h
    if st.h then
        if not sel then
            st.h = false
            announce("‚ö†Ô∏è SELECT A PLAYER!", 2)
            return
        end
        cn.h = RS.Heartbeat:Connect(function()
            if not st.h or not sel or not sel.Character then return end
            local root = getRoot()
            local targetRoot = sel.Character:FindFirstChild("HumanoidRootPart")
            if not root or not targetRoot then return end
            
            local th = math.sin(tick() * 10)
            -- NO TILTING - Just back and forth motion!
            root.CFrame = targetRoot.CFrame * CFrame.new(0, 0, 2 + th * 1.5)
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üòà HUMPING " .. sel.Name, 2)
    else
        if cn.h then cn.h:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

b("TP TO", function(f)
    if sel and sel.Character then
        local root = getRoot()
        local targetRoot = sel.Character:FindFirstChild("HumanoidRootPart")
        if root and targetRoot then
            root.CFrame = targetRoot.CFrame * CFrame.new(0, 0, 3)
            announce("üìç TELEPORTED", 1)
        end
    else
        announce("‚ö†Ô∏è SELECT A PLAYER!", 2)
    end
end)

b("FOLLOW", function(f)
    st.w = not st.w
    if st.w then
        if not sel then
            st.w = false
            announce("‚ö†Ô∏è SELECT A PLAYER!", 2)
            return
        end
        cn.w = RS.Heartbeat:Connect(function()
            if not st.w or not sel or not sel.Character then return end
            local root = getRoot()
            local targetRoot = sel.Character:FindFirstChild("HumanoidRootPart")
            if root and targetRoot then
                root.CFrame = targetRoot.CFrame * CFrame.new(0, 0, 3)
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üéØ FOLLOWING " .. sel.Name, 2)
    else
        if cn.w then cn.w:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- IMPROVED FLING (More aggressive!)
b("FLING", function(f)
    st.l = not st.l
    if st.l then
        local root = getRoot()
        if root then
            local spin = Instance.new("BodyAngularVelocity")
            spin.Name = "Spin"
            spin.MaxTorque = Vector3.new(0, math.huge, 0)
            spin.AngularVelocity = Vector3.new(0, 500, 0) -- MUCH FASTER!
            spin.P = 10000
            spin.Parent = root
            
            -- Make character uncollidable except root
            cn.l = RS.Heartbeat:Connect(function()
                if not st.l then return end
                local char = getChar()
                if not char then return end
                for _, v in pairs(char:GetDescendants()) do
                    if v:IsA("BasePart") and v ~= root then
                        v.CanCollide = false
                    else
                        v.CanCollide = true
                    end
                end
            end)
        end
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üí• FLING ACTIVATED!", 2)
    else
        if cn.l then cn.l:Disconnect() end
        local root = getRoot()
        if root and root:FindFirstChild("Spin") then
            root.Spin:Destroy()
        end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

b("SPIN", function(f)
    st.p = not st.p
    if st.p then
        cn.p = RS.Heartbeat:Connect(function()
            local root = getRoot()
            if root then
                root.CFrame = root.CFrame * CFrame.Angles(0, math.rad(20), 0)
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    else
        if cn.p then cn.p:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- REMOVE HEAD (Everyone sees!)
b("REMOVE HEAD", function(f)
    st.rh = not st.rh
    local char = getChar()
    if st.rh and char and char:FindFirstChild("Head") then
        char.Head:Destroy()
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üë§ HEAD REMOVED!", 2)
    else
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- CRAZY LIMBS (Everyone sees!)
b("CRAZY LIMBS", function(f)
    st.cl = not st.cl
    if st.cl then
        cn.cl = RS.Heartbeat:Connect(function()
            if not st.cl then return end
            local char = getChar()
            if not char then return end
            
            -- R15
            if char:FindFirstChild("RightUpperArm") then
                local rua = char.RightUpperArm
                local lua = char.LeftUpperArm
                local rla = char.RightUpperLeg
                local lla = char.LeftUpperLeg
                
                rua.CFrame = rua.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
                lua.CFrame = lua.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
                rla.CFrame = rla.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
                lla.CFrame = lla.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
            end
            -- R6
            if char:FindFirstChild("Right Arm") then
                local ra = char["Right Arm"]
                local la = char["Left Arm"]
                local rl = char["Right Leg"]
                local ll = char["Left Leg"]
                
                ra.CFrame = ra.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
                la.CFrame = la.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
                rl.CFrame = rl.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
                ll.CFrame = ll.CFrame * CFrame.Angles(math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)), math.rad(math.random(-30, 30)))
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("ü§™ CRAZY LIMBS!", 2)
    else
        if cn.cl then cn.cl:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- SEIZURE
b("SEIZURE", function(f)
    st.sz = not st.sz
    if st.sz then
        cn.sz = RS.Heartbeat:Connect(function()
            local root = getRoot()
            if root then
                root.CFrame = root.CFrame * CFrame.new(
                    math.random(-2, 2),
                    math.random(-2, 2),
                    math.random(-2, 2)
                ) * CFrame.Angles(
                    math.rad(math.random(-45, 45)),
                    math.rad(math.random(-45, 45)),
                    math.rad(math.random(-45, 45))
                )
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üì≥ SEIZURE MODE!", 2)
    else
        if cn.sz then cn.sz:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- ORBIT PLAYER
b("ORBIT", function(f)
    st.or = not st.or
    if st.or then
        if not sel then
            st.or = false
            announce("‚ö†Ô∏è SELECT A PLAYER!", 2)
            return
        end
        local angle = 0
        cn.or = RS.Heartbeat:Connect(function()
            if not st.or or not sel or not sel.Character then return end
            local root = getRoot()
            local targetRoot = sel.Character:FindFirstChild("HumanoidRootPart")
            if root and targetRoot then
                angle = angle + 0.1
                local x = math.cos(angle) * 10
                local z = math.sin(angle) * 10
                root.CFrame = targetRoot.CFrame * CFrame.new(x, 3, z)
            end
        end)
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üåç ORBITING " .. sel.Name, 2)
    else
        if cn.or then cn.or:Disconnect() end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

-- HIDE USERNAME (Fake name display)
b("HIDE NAME", function(f)
    st.hn = not st.hn
    local char = getChar()
    if st.hn and char then
        -- Remove default name
        for _, v in pairs(char:GetDescendants()) do
            if v:IsA("BillboardGui") or v.Name == "NameTag" then
                v:Destroy()
            end
        end
        
        -- Create fake name
        local head = char:FindFirstChild("Head")
        if head then
            local bb = Instance.new("BillboardGui")
            bb.Name = "FakeName"
            bb.Size = UDim2.new(0, 200, 0, 50)
            bb.StudsOffset = Vector3.new(0, 2, 0)
            bb.AlwaysOnTop = true
            bb.Parent = head
            
            local txt = Instance.new("TextLabel")
            txt.Size = UDim2.new(1, 0, 1, 0)
            txt.BackgroundTransparency = 1
            txt.Text = "Unknown User"
            txt.TextColor3 = Color3.fromRGB(255, 255, 255)
            txt.TextSize = 14
            txt.Font = Enum.Font.GothamBold
            txt.Parent = bb
        end
        
        f.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
        announce("üïµÔ∏è NAME HIDDEN!", 2)
    else
        local char = getChar()
        if char then
            for _, v in pairs(char:GetDescendants()) do
                if v.Name == "FakeName" then
                    v:Destroy()
                end
            end
        end
        f.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
    end
end)

announce("üíÄ MATTHEW HIPPO ULTIMATE LOADED! üíÄ", 3)
print("ü¶õ All features ready!")
print("‚úÖ Noclip + God Mode (No death in staff areas!)")
print("‚úÖ Fixed Fly")
print("‚úÖ Fixed Hump (No hunching)")
print("‚úÖ Improved Fling")
print("‚úÖ Crazy Limbs")
print("‚úÖ Auto-reconnect on respawn")
print("‚úÖ Announcements system")
print("‚úÖ Name hiding")
