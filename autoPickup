local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "NexaAutoCollectGui"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Create Main Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 280, 0, 150)
frame.Position = UDim2.new(0.5, -140, 0, 30)
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BorderSizePixel = 0
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui

local frameCorner = Instance.new("UICorner")
frameCorner.CornerRadius = UDim.new(0, 12)
frameCorner.Parent = frame

-- Create Rainbow Outline
local outline = Instance.new("UIStroke")
outline.Thickness = 3
outline.Parent = frame

-- Rainbow animation for outline
local hue = 0
game:GetService("RunService").Heartbeat:Connect(function()
    hue = hue + 0.005
    if hue >= 1 then hue = 0 end
    outline.Color = Color3.fromHSV(hue, 1, 1)
end)

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, 0, 0, 30)
title.Position = UDim2.new(0, 0, 0, 5)
title.BackgroundTransparency = 1
title.Text = "NEXA AUTO COLLECT"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.Parent = frame

-- Create Auto Collect Toggle Button
local collectButton = Instance.new("TextButton")
collectButton.Size = UDim2.new(0, 250, 0, 45)
collectButton.Position = UDim2.new(0.5, -125, 0, 40)
collectButton.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
collectButton.Text = "AUTO COLLECT CASH: OFF"
collectButton.TextColor3 = Color3.fromRGB(0, 100, 0)
collectButton.Font = Enum.Font.GothamBold
collectButton.TextSize = 13
collectButton.BorderSizePixel = 0
collectButton.Parent = frame

local collectButtonCorner = Instance.new("UICorner")
collectButtonCorner.CornerRadius = UDim.new(0, 8)
collectButtonCorner.Parent = collectButton

local collectButtonStroke = Instance.new("UIStroke")
collectButtonStroke.Thickness = 2
collectButtonStroke.Color = Color3.fromRGB(0, 80, 0)
collectButtonStroke.Parent = collectButton

-- Create Auto Lock Toggle Button
local lockButton = Instance.new("TextButton")
lockButton.Size = UDim2.new(0, 250, 0, 45)
lockButton.Position = UDim2.new(0.5, -125, 0, 95)
lockButton.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
lockButton.Text = "AUTO LOCK BASE: OFF"
lockButton.TextColor3 = Color3.fromRGB(100, 0, 100)
lockButton.Font = Enum.Font.GothamBold
lockButton.TextSize = 13
lockButton.BorderSizePixel = 0
lockButton.Parent = frame

local lockButtonCorner = Instance.new("UICorner")
lockButtonCorner.CornerRadius = UDim.new(0, 8)
lockButtonCorner.Parent = lockButton

local lockButtonStroke = Instance.new("UIStroke")
lockButtonStroke.Thickness = 2
lockButtonStroke.Color = Color3.fromRGB(80, 0, 80)
lockButtonStroke.Parent = lockButton

-- State variables
local autoCollectEnabled = false
local autoLockEnabled = false

-- Toggle auto collect function
collectButton.MouseButton1Click:Connect(function()
    autoCollectEnabled = not autoCollectEnabled
   
    if autoCollectEnabled then
        collectButton.TextColor3 = Color3.fromRGB(0, 255, 0)
        collectButton.Text = "AUTO COLLECT CASH: ON"
        collectButtonStroke.Color = Color3.fromRGB(0, 255, 0)
    else
        collectButton.TextColor3 = Color3.fromRGB(0, 100, 0)
        collectButton.Text = "AUTO COLLECT CASH: OFF"
        collectButtonStroke.Color = Color3.fromRGB(0, 80, 0)
    end
end)

-- Toggle auto lock function
lockButton.MouseButton1Click:Connect(function()
    autoLockEnabled = not autoLockEnabled
    
    if autoLockEnabled then
        lockButton.TextColor3 = Color3.fromRGB(255, 0, 255)
        lockButton.Text = "AUTO LOCK BASE: ON"
        lockButtonStroke.Color = Color3.fromRGB(255, 0, 255)
    else
        lockButton.TextColor3 = Color3.fromRGB(100, 0, 100)
        lockButton.Text = "AUTO LOCK BASE: OFF"
        lockButtonStroke.Color = Color3.fromRGB(80, 0, 80)
    end
end)

-- Function to collect cash
local function collectCash()
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("ClickDetector") then
            local parent = obj.Parent
            if parent and parent:IsA("Part") then
                -- Check if it's a cash part (usually named "Cash" or has certain properties)
                if parent.Name:lower():find("cash") or parent.Name:lower():find("money") or 
                   parent.BrickColor == BrickColor.new("Lime green") or 
                   parent.Color == Color3.fromRGB(0, 255, 0) then
                    
                    -- Fire the click detector
                    local success = pcall(function()
                        fireclickdetector(obj)
                    end)
                    
                    if not success then
                        -- Fallback method if fireclickdetector doesn't work
                        pcall(function()
                            local character = player.Character
                            if character then
                                local rootPart = character:FindFirstChild("HumanoidRootPart")
                                if rootPart then
                                    local oldCFrame = rootPart.CFrame
                                    rootPart.CFrame = parent.CFrame
                                    task.wait(0.1)
                                    fireclickdetector(obj)
                                    task.wait(0.1)
                                    rootPart.CFrame = oldCFrame
                                end
                            end
                        end)
                    end
                end
            end
        end
    end
end

-- Function to lock base
local function lockBase()
    -- Look for lock button in player's base
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj:IsA("ClickDetector") and obj.Parent then
            local parent = obj.Parent
            if parent.Name:lower():find("lock") or parent.Name:lower():find("button") then
                -- Check if it's near the player's base
                local character = player.Character
                if character and character:FindFirstChild("HumanoidRootPart") then
                    local distance = (parent.Position - character.HumanoidRootPart.Position).Magnitude
                    if distance < 100 then
                        pcall(function()
                            fireclickdetector(obj)
                        end)
                    end
                end
            end
        end
    end
end

-- Main auto collect loop
task.spawn(function()
    while task.wait(0.5) do
        if autoCollectEnabled then
            pcall(collectCash)
        end
    end
end)

-- Main auto lock loop
task.spawn(function()
    while task.wait(2) do
        if autoLockEnabled then
            pcall(lockBase)
        end
    end
end)

-- Alternative method: Listen for new cash parts being added
workspace.DescendantAdded:Connect(function(obj)
    if autoCollectEnabled then
        task.wait(0.1)
        if obj:IsA("ClickDetector") then
            local parent = obj.Parent
            if parent and parent:IsA("Part") then
                if parent.Name:lower():find("cash") or parent.Name:lower():find("money") or 
                   parent.BrickColor == BrickColor.new("Lime green") or 
                   parent.Color == Color3.fromRGB(0, 255, 0) then
                    task.wait(0.2)
                    pcall(function()
                        fireclickdetector(obj)
                    end)
                end
            end
        end
    end
end)

print("âœ… NEXA Auto Collect Cash loaded successfully!")
print("ðŸ’° Toggle Auto Collect to start collecting cash automatically")
print("ðŸ”’ Toggle Auto Lock to automatically lock your base")
