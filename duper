-- RIVALS UNDETECTABLE
-- No Drawing API | GUI ESP | Custom Keybinds | Full Bypass

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local Camera = workspace.CurrentCamera
local LocalPlayer = Players.LocalPlayer
local playerGui = LocalPlayer:WaitForChild("PlayerGui")

print("üîí RIVALS UNDETECTABLE LOADING...")

-- Settings
local Settings = {
    AimAssist = true,
    AimKey = Enum.KeyCode.E, -- DEFAULT: E key (changeable in UI)
    AimSmoothness = 0.12,
    AimPart = "Head",
    MaxAimDistance = 300,
    FOVRadius = 120,
    ShowFOV = false,
    
    ESP = true,
    ESPBoxes = true,
    ESPNames = true,
    ESPHealth = true,
    ESPDistance = true,
    ESPTeamCheck = true,
    
    ESPColor = Color3.fromRGB(138, 43, 226),
    TeamColor = false,
}

-- Lobby Detection (CRITICAL)
local inMatch = false

local function IsInMatch()
    if not LocalPlayer.Character then return false end
    if not LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then return false end
    
    -- Check for active gameplay indicators
    local playersAlive = 0
    for _, player in pairs(Players:GetPlayers()) do
        if player.Character and player.Character:FindFirstChild("Humanoid") then
            if player.Character.Humanoid.Health > 0 then
                playersAlive = playersAlive + 1
            end
        end
    end
    
    -- Check if we have a weapon
    local hasWeapon = false
    if LocalPlayer.Character then
        hasWeapon = LocalPlayer.Character:FindFirstChild("Weapon") or
                    LocalPlayer.Character:FindFirstChildOfClass("Tool") or
                    LocalPlayer.Backpack:FindFirstChildOfClass("Tool")
    end
    
    return playersAlive >= 3 or hasWeapon
end

-- Update match status
task.spawn(function()
    while true do
        local wasInMatch = inMatch
        inMatch = IsInMatch()
        
        if inMatch and not wasInMatch then
            print("‚ö° Match started - Features enabled")
        elseif not inMatch and wasInMatch then
            print("üîí Lobby detected - Features disabled")
        end
        
        task.wait(2)
    end
end)

-- ESP Container (GUI-based, safer than Drawing API)
local espContainer = Instance.new("ScreenGui")
espContainer.Name = "ESPContainer"
espContainer.ResetOnSpawn = false
espContainer.IgnoreGuiInset = true
espContainer.Parent = playerGui

local ESPObjects = {}

-- Get closest player
local function GetClosestPlayerToCrosshair()
    local closestPlayer = nil
    local shortestDistance = Settings.FOVRadius
    
    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character then
            local character = player.Character
            local humanoid = character:FindFirstChild("Humanoid")
            local aimPart = character:FindFirstChild(Settings.AimPart)
            
            if humanoid and humanoid.Health > 0 and aimPart then
                if Settings.ESPTeamCheck and player.Team and LocalPlayer.Team then
                    if player.Team == LocalPlayer.Team then
                        continue
                    end
                end
                
                local distance = (aimPart.Position - Camera.CFrame.Position).Magnitude
                if distance > Settings.MaxAimDistance then
                    continue
                end
                
                local screenPos, onScreen = Camera:WorldToViewportPoint(aimPart.Position)
                if not onScreen then
                    continue
                end
                
                local mousePos = UserInputService:GetMouseLocation()
                local distanceFromMouse = (Vector2.new(screenPos.X, screenPos.Y) - mousePos).Magnitude
                
                if distanceFromMouse < shortestDistance then
                    shortestDistance = distanceFromMouse
                    closestPlayer = player
                end
            end
        end
    end
    
    return closestPlayer
end

-- Smooth aim
local function AimAt(player)
    if not player or not player.Character then return end
    
    local aimPart = player.Character:FindFirstChild(Settings.AimPart)
    if not aimPart then return end
    
    local targetPos = aimPart.Position
    local currentCFrame = Camera.CFrame
    local targetCFrame = CFrame.new(currentCFrame.Position, targetPos)
    
    Camera.CFrame = currentCFrame:Lerp(targetCFrame, Settings.AimSmoothness)
end

-- Create GUI-based ESP
local function CreateESP(player)
    if ESPObjects[player] then return end
    
    local espFrame = Instance.new("Frame")
    espFrame.Name = player.Name
    espFrame.BackgroundTransparency = 1
    espFrame.Size = UDim2.new(0, 200, 0, 200)
    espFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
    espFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    espFrame.Parent = espContainer
    
    -- Box
    local box = Instance.new("Frame")
    box.Name = "Box"
    box.BackgroundTransparency = 1
    box.BorderSizePixel = 2
    box.BorderColor3 = Settings.ESPColor
    box.Size = UDim2.new(1, 0, 1, 0)
    box.Parent = espFrame
    
    Instance.new("UICorner", box).CornerRadius = UDim.new(0, 4)
    
    -- Name
    local nameTag = Instance.new("TextLabel")
    nameTag.Name = "NameTag"
    nameTag.Size = UDim2.new(1, 0, 0, 20)
    nameTag.Position = UDim2.new(0, 0, 0, -25)
    nameTag.BackgroundTransparency = 1
    nameTag.Text = player.Name
    nameTag.TextColor3 = Settings.ESPColor
    nameTag.Font = Enum.Font.GothamBold
    nameTag.TextSize = 12
    nameTag.TextStrokeTransparency = 0.5
    nameTag.Parent = espFrame
    
    -- Health bar
    local healthBg = Instance.new("Frame")
    healthBg.Name = "HealthBg"
    healthBg.Size = UDim2.new(0, 3, 1, 0)
    healthBg.Position = UDim2.new(0, -8, 0, 0)
    healthBg.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    healthBg.BorderSizePixel = 0
    healthBg.Parent = espFrame
    
    local healthBar = Instance.new("Frame")
    healthBar.Name = "HealthBar"
    healthBar.Size = UDim2.new(1, 0, 1, 0)
    healthBar.Position = UDim2.new(0, 0, 0, 0)
    healthBar.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    healthBar.BorderSizePixel = 0
    healthBar.Parent = healthBg
    
    -- Distance
    local distance = Instance.new("TextLabel")
    distance.Name = "Distance"
    distance.Size = UDim2.new(1, 0, 0, 15)
    distance.Position = UDim2.new(0, 0, 1, 5)
    distance.BackgroundTransparency = 1
    distance.Text = "0m"
    distance.TextColor3 = Settings.ESPColor
    distance.Font = Enum.Font.Gotham
    distance.TextSize = 11
    distance.TextStrokeTransparency = 0.5
    distance.Parent = espFrame
    
    ESPObjects[player] = espFrame
end

-- Update ESP
local function UpdateESP()
    for player, espFrame in pairs(ESPObjects) do
        -- Hide in lobby
        if not inMatch then
            espFrame.Visible = false
            goto continue
        end
        
        if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local character = player.Character
            local humanoid = character:FindFirstChild("Humanoid")
            local rootPart = character.HumanoidRootPart
            
            if humanoid and humanoid.Health > 0 then
                -- Team check
                local shouldHide = Settings.ESPTeamCheck and player.Team and LocalPlayer.Team and player.Team == LocalPlayer.Team
                
                if not shouldHide and Settings.ESP then
                    local screenPos, onScreen = Camera:WorldToViewportPoint(rootPart.Position)
                    
                    if onScreen then
                        local headPos = Camera:WorldToViewportPoint((character:FindFirstChild("Head") or rootPart).Position + Vector3.new(0, 0.5, 0))
                        local legPos = Camera:WorldToViewportPoint((character:FindFirstChild("LeftFoot") or rootPart).Position - Vector3.new(0, 3, 0))
                        
                        local height = math.abs(headPos.Y - legPos.Y)
                        local width = height / 2
                        local distance = math.floor((Camera.CFrame.Position - rootPart.Position).Magnitude)
                        
                        -- Update position and size
                        espFrame.Position = UDim2.new(0, screenPos.X, 0, screenPos.Y)
                        espFrame.Size = UDim2.new(0, width, 0, height)
                        
                        -- Update box
                        local box = espFrame:FindFirstChild("Box")
                        if box and Settings.ESPBoxes then
                            box.BorderColor3 = Settings.TeamColor and player.Team and player.Team.TeamColor.Color or Settings.ESPColor
                            box.Visible = true
                        elseif box then
                            box.Visible = false
                        end
                        
                        -- Update name
                        local nameTag = espFrame:FindFirstChild("NameTag")
                        if nameTag and Settings.ESPNames then
                            nameTag.TextColor3 = Settings.TeamColor and player.Team and player.Team.TeamColor.Color or Settings.ESPColor
                            nameTag.Visible = true
                        elseif nameTag then
                            nameTag.Visible = false
                        end
                        
                        -- Update health
                        local healthBar = espFrame:FindFirstChild("HealthBg") and espFrame.HealthBg:FindFirstChild("HealthBar")
                        if healthBar and Settings.ESPHealth then
                            local healthPercent = humanoid.Health / humanoid.MaxHealth
                            healthBar.Size = UDim2.new(1, 0, healthPercent, 0)
                            healthBar.Position = UDim2.new(0, 0, 1 - healthPercent, 0)
                            healthBar.BackgroundColor3 = Color3.fromRGB(255 * (1 - healthPercent), 255 * healthPercent, 0)
                            espFrame.HealthBg.Visible = true
                        elseif espFrame:FindFirstChild("HealthBg") then
                            espFrame.HealthBg.Visible = false
                        end
                        
                        -- Update distance
                        local distLabel = espFrame:FindFirstChild("Distance")
                        if distLabel and Settings.ESPDistance then
                            distLabel.Text = tostring(distance) .. "m"
                            distLabel.TextColor3 = Settings.TeamColor and player.Team and player.Team.TeamColor.Color or Settings.ESPColor
                            distLabel.Visible = true
                        elseif distLabel then
                            distLabel.Visible = false
                        end
                        
                        espFrame.Visible = true
                    else
                        espFrame.Visible = false
                    end
                else
                    espFrame.Visible = false
                end
            else
                espFrame.Visible = false
            end
        else
            espFrame:Destroy()
            ESPObjects[player] = nil
        end
        
        ::continue::
    end
end

-- Remove ESP
local function RemoveESP(player)
    if ESPObjects[player] then
        ESPObjects[player]:Destroy()
        ESPObjects[player] = nil
    end
end

-- Initialize
for _, player in pairs(Players:GetPlayers()) do
    if player ~= LocalPlayer then
        CreateESP(player)
    end
end

Players.PlayerAdded:Connect(CreateESP)
Players.PlayerRemoving:Connect(RemoveESP)

-- Aim logic
local aiming = false

UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Settings.AimKey then
        aiming = true
    end
end)

UserInputService.InputEnded:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Settings.AimKey then
        aiming = false
    end
end)

-- Main loop
RunService.RenderStepped:Connect(function()
    if Settings.AimAssist and aiming and inMatch then
        local target = GetClosestPlayerToCrosshair()
        if target then
            AimAt(target)
        end
    end
    
    UpdateESP()
end)

LocalPlayer.CharacterAdded:Connect(function()
    task.wait(1)
    Camera = workspace.CurrentCamera
end)

print("‚úÖ CORE LOADED!")

-- UI with keybind system
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "RivalsUndetectableUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = playerGui

local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 400, 0, 60)
mainFrame.Position = UDim2.new(0.5, -200, 0.02, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 28)
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 14)

local glow = Instance.new("UIStroke")
glow.Color = Color3.fromRGB(138, 43, 226)
glow.Thickness = 2
glow.Transparency = 0.5
glow.Parent = mainFrame

-- Header
local header = Instance.new("Frame")
header.Size = UDim2.new(1, 0, 0, 60)
header.BackgroundTransparency = 1
header.Parent = mainFrame

local title = Instance.new("TextLabel")
title.Size = UDim2.new(0, 200, 1, 0)
title.Position = UDim2.new(0, 15, 0, 0)
title.BackgroundTransparency = 1
title.Text = "üîí RIVALS STEALTH"
title.TextColor3 = Color3.fromRGB(255, 255, 255)
title.Font = Enum.Font.GothamBold
title.TextSize = 16
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = header

local status = Instance.new("TextLabel")
status.Size = UDim2.new(0, 150, 1, 0)
status.Position = UDim2.new(1, -160, 0, 0)
status.BackgroundTransparency = 1
status.Text = "üîí LOBBY"
status.TextColor3 = Color3.fromRGB(255, 255, 255)
status.Font = Enum.Font.GothamBold
status.TextSize = 13
status.TextXAlignment = Enum.TextXAlignment.Right
status.Parent = header

local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 35, 0, 35)
toggleBtn.Position = UDim2.new(1, -45, 0.5, -17.5)
toggleBtn.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
toggleBtn.Text = "‚ñº"
toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.TextSize = 14
toggleBtn.Parent = header

Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(0, 8)

-- Content
local content = Instance.new("Frame")
content.Size = UDim2.new(1, -20, 1, -70)
content.Position = UDim2.new(0, 10, 0, 70)
content.BackgroundTransparency = 1
content.Visible = false
content.Parent = mainFrame

local layout = Instance.new("UIListLayout")
layout.Padding = UDim.new(0, 8)
layout.Parent = content

-- Keybind button
local function CreateKeybindButton(name, currentKey, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, 40)
    btn.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
    btn.Text = ""
    btn.Parent = content
    
    Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -100, 1, 0)
    label.Position = UDim2.new(0, 12, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = name
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.GothamBold
    label.TextSize = 13
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = btn
    
    local keyLabel = Instance.new("TextLabel")
    keyLabel.Size = UDim2.new(0, 80, 0, 28)
    keyLabel.Position = UDim2.new(1, -90, 0.5, -14)
    keyLabel.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    keyLabel.Text = currentKey.Name
    keyLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    keyLabel.Font = Enum.Font.GothamBold
    keyLabel.TextSize = 12
    keyLabel.Parent = btn
    
    Instance.new("UICorner", keyLabel).CornerRadius = UDim.new(0, 6)
    
    local binding = false
    
    btn.MouseButton1Click:Connect(function()
        if binding then return end
        binding = true
        keyLabel.Text = "..."
        keyLabel.BackgroundColor3 = Color3.fromRGB(255, 100, 100)
        
        local connection
        connection = UserInputService.InputBegan:Connect(function(input, gp)
            if gp then return end
            if input.UserInputType == Enum.UserInputType.Keyboard then
                connection:Disconnect()
                callback(input.KeyCode)
                keyLabel.Text = input.KeyCode.Name
                keyLabel.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
                binding = false
            end
        end)
    end)
    
    return btn
end

-- Toggle
local function CreateToggle(name, default, callback)
    local toggle = Instance.new("Frame")
    toggle.Size = UDim2.new(1, 0, 0, 40)
    toggle.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
    toggle.Parent = content
    
    Instance.new("UICorner", toggle).CornerRadius = UDim.new(0, 8)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -70, 1, 0)
    label.Position = UDim2.new(0, 12, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = name
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.Gotham
    label.TextSize = 13
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = toggle
    
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(0, 45, 0, 24)
    btn.Position = UDim2.new(1, -55, 0.5, -12)
    btn.BackgroundColor3 = default and Color3.fromRGB(138, 43, 226) or Color3.fromRGB(50, 50, 60)
    btn.Text = ""
    btn.Parent = toggle
    
    Instance.new("UICorner", btn).CornerRadius = UDim.new(1, 0)
    
    local indicator = Instance.new("Frame")
    indicator.Size = UDim2.new(0, 18, 0, 18)
    indicator.Position = default and UDim2.new(1, -21, 0.5, -9) or UDim2.new(0, 3, 0.5, -9)
    indicator.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    indicator.Parent = btn
    
    Instance.new("UICorner", indicator).CornerRadius = UDim.new(1, 0)
    
    local enabled = default
    
    btn.MouseButton1Click:Connect(function()
        enabled = not enabled
        callback(enabled)
        
        TweenService:Create(btn, TweenInfo.new(0.2), {
            BackgroundColor3 = enabled and Color3.fromRGB(138, 43, 226) or Color3.fromRGB(50, 50, 60)
        }):Play()
        
        TweenService:Create(indicator, TweenInfo.new(0.2), {
            Position = enabled and UDim2.new(1, -21, 0.5, -9) or UDim2.new(0, 3, 0.5, -9)
        }):Play()
    end)
end

-- Slider
local function CreateSlider(name, min, max, default, callback)
    local slider = Instance.new("Frame")
    slider.Size = UDim2.new(1, 0, 0, 50)
    slider.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
    slider.Parent = content
    
    Instance.new("UICorner", slider).CornerRadius = UDim.new(0, 8)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -60, 0, 20)
    label.Position = UDim2.new(0, 12, 0, 6)
    label.BackgroundTransparency = 1
    label.Text = name
    label.TextColor3 = Color3.fromRGB(255, 255, 255)
    label.Font = Enum.Font.Gotham
    label.TextSize = 12
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = slider
    
    local valueLabel = Instance.new("TextLabel")
    valueLabel.Size = UDim2.new(0, 50, 0, 20)
    valueLabel.Position = UDim2.new(1, -60, 0, 6)
    valueLabel.BackgroundTransparency = 1
    valueLabel.Text = tostring(default)
    valueLabel.TextColor3 = Color3.fromRGB(138, 43, 226)
    valueLabel.Font = Enum.Font.GothamBold
    valueLabel.TextSize = 12
    valueLabel.TextXAlignment = Enum.TextXAlignment.Right
    valueLabel.Parent = slider
    
    local bar = Instance.new("Frame")
    bar.Size = UDim2.new(1, -24, 0, 4)
    bar.Position = UDim2.new(0, 12, 1, -14)
    bar.BackgroundColor3 = Color3.fromRGB(50, 50, 60)
    bar.BorderSizePixel = 0
    bar.Parent = slider
    
    Instance.new("UICorner", bar).CornerRadius = UDim.new(1, 0)
    
    local fill = Instance.new("Frame")
    fill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
    fill.BackgroundColor3 = Color3.fromRGB(138, 43, 226)
    fill.BorderSizePixel = 0
    fill.Parent = bar
    
    Instance.new("UICorner", fill).CornerRadius = UDim.new(1, 0)
    
    local dragging = false
    
    local function update(input)
        local pos = math.clamp((input.Position.X - bar.AbsolutePosition.X) / bar.AbsoluteSize.X, 0, 1)
        local value = min + (max - min) * pos
        value = math.floor(value * 100) / 100
        
        fill.Size = UDim2.new(pos, 0, 1, 0)
        valueLabel.Text = tostring(value)
        callback(value)
    end
    
    bar.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            update(input)
        end
    end)
    
    bar.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            update(input)
        end
    end)
end

-- Create UI
CreateKeybindButton("üéØ Aim Key", Settings.AimKey, function(key)
    Settings.AimKey = key
    print("Aim key set to:", key.Name)
end)

CreateToggle("Aim Assist", Settings.AimAssist, function(v) Settings.AimAssist = v end)
CreateToggle("ESP", Settings.ESP, function(v) Settings.ESP = v end)
CreateToggle("Boxes", Settings.ESPBoxes, function(v) Settings.ESPBoxes = v end)
CreateToggle("Names", Settings.ESPNames, function(v) Settings.ESPNames = v end)
CreateToggle("Health", Settings.ESPHealth, function(v) Settings.ESPHealth = v end)
CreateToggle("Distance", Settings.ESPDistance, function(v) Settings.ESPDistance = v end)
CreateToggle("Team Check", Settings.ESPTeamCheck, function(v) Settings.ESPTeamCheck = v end)

CreateSlider("FOV Size", 50, 300, Settings.FOVRadius, function(v) Settings.FOVRadius = v end)
CreateSlider("Smoothness", 0.05, 0.5, Settings.AimSmoothness, function(v) Settings.AimSmoothness = v end)
CreateSlider("Max Distance", 100, 500, Settings.MaxAimDistance, function(v) Settings.MaxAimDistance = v end)

-- Toggle expand
local expanded = false
toggleBtn.MouseButton1Click:Connect(function()
    expanded = not expanded
    
    local targetSize = expanded and UDim2.new(0, 400, 0, 480) or UDim2.new(0, 400, 0, 60)
    TweenService:Create(mainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quint), {Size = targetSize}):Play()
    TweenService:Create(toggleBtn, TweenInfo.new(0.3), {Rotation = expanded and 180 or 0}):Play()
    
    content.Visible = expanded
end)

-- Status update
task.spawn(function()
    while true do
        if inMatch then
            status.Text = "‚ö° IN MATCH"
            status.TextColor3 = Color3.fromRGB(0, 255, 136)
        else
            status.Text = "üîí LOBBY"
            status.TextColor3 = Color3.fromRGB(255, 255, 255)
        end
        task.wait(1)
    end
end)

-- Drag
local dragging = false
local dragInput, dragStart, startPos

header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Toggle UI
UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == Enum.KeyCode.Insert then
        mainFrame.Visible = not mainFrame.Visible
    end
end)

print("‚úÖ RIVALS UNDETECTABLE LOADED!")
print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
print("üîí NO DRAWING API (Safer)")
print("‚öôÔ∏è Keybind: Click to change")
print("üí° INSERT: Toggle UI")
print("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
